//Процедура на заполненеие этапов
&НаСервере
Процедура ПрограммнаяНастройкаБизнесПроцесса() 
	//служебные переменные
	ПредметыВыборка = Объект.Предметы.НайтиПоИдентификатору(0);
	Предмет = ПредметыВыборка.Предмет;
	Документ = Справочники.ВнутренниеДокументы.НайтиПоНаименованию(Предмет); 
	Автор = Документ.Подготовил; 
	
	//заполнение временной таблицы для выявления пользователей
	Получатели = ДополнениеКомплексногоБП.ПолучитьПолучателей(Документ);
	РуководителяАвтора = ДополнениеКомплексногоБП.НайтиРуководителяАвтора(Получатели, Документ);
	РуководительАдресета = ДополнениеКомплексногоБП.НайтиРуководителяАдресата(Получатели, Документ); 
		
	//Заполнение таблички
		Если ЗначениеЗаполнено(Получатели.Найти(РуководителяАвтора, "Пользователь")) Тогда
			ДополнениеКомплексногоБП.СозданиеШаблонаСогласованияИЗаполнениеСтроки(Автор, 
																				  РуководителяАвтора, 
																				  Объект);
				Если ЗначениеЗаполнено(Получатели.Найти(РуководительАдресета, "Пользователь")) Тогда
					ДополнениеКомплексногоБП.СозданиеШаблонаРассмотрениеИЗаполнениеСтроки (Автор, 
																						   РуководительАдресета, 
																						   Объект);
				КонецЕсли;   
				
		ИначеЕсли ЗначениеЗаполнено(Получатели.Найти(РуководительАдресета, "Пользователь")) Тогда 
			ДополнениеКомплексногоБП.СозданиеШаблонаРассмотрениеИЗаполнениеСтроки (Автор, 
																				   РуководительАдресета, 
																				   Объект);
				Если ЗначениеЗаполнено(Получатели.Найти(РуководителяАвтора, "Пользователь")) Тогда
					ДополнениеКомплексногоБП.СозданиеШаблонаСогласованияИЗаполнениеСтроки(Автор, 
																						  РуководителяАвтора, 
																						  Объект);
				КонецЕсли;
			КонецЕсли; 
				
	ДополнениеКомплексногоБП.СозданиеШаблонаИсполненияИЗаполнениеСтроки (Автор, 
																		 Получатели, 
																		 РуководителяАвтора, 
																		 РуководительАдресета, 
																		 Объект);			
		
	СрокиЭтапов = СрокиИсполненияПроцессов.СрокиДействийПроцесса(Объект.Этапы, "ИдентификаторЭтапа");
	ОчиститьДатуОтсчетаДляРасчетаСроков(ЭтаФорма);
	ОбновитьСрокиИсполненияНаСервере();
КонецПроцедуры

//Вход в процедуры для заполнения	
&НаСервере
Процедура ПР_ПриСозданииНаСервереПосле(Отказ, СтандартнаяОбработка)
	Если СокрЛП(Объект.Шаблон) = "Обработка служебной записки" Тогда 
		ПрограммнаяНастройкаБизнесПроцесса(); 
	КонецЕсли;
КонецПроцедуры    

